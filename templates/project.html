{% extends "MainPage.html" %}

{% block Title %}
    Project {{project.project_name}}
{% endblock %}

{% block body %}
<br><br><br>


<div class="container emp-profile">
    
    <table id="DT_load" class="table table-striped" >
        <tbody>
            
            



        {% if Depth == 1 %}
            {% for key in project.keys() %}
                {% if (key != "score") and (key != "Depth") %}
                <tr>

                    {{key}}

                </tr>
                
                    {% for value in project[key] %}
                        
                        <tr>
                            {% if (key != "score") and (key != "Depth") %}
                                <td style = "color:red; padding-left: 50px;">
                                    {{value}}
                                </td>
                                <td>
                                    {{project[key][value]}}
                                </td>
                            {% endif %}
                        </tr>

                    {% endfor %}
                {% endif %}
            {% endfor %}

        {% else %}
            {% for key in project.keys() %}
                    {% if (key != "score") and (key != "Depth") %}
                    <tr>
                        {{key}}
                    </tr>
                        {% for key2 in project[key].keys() %}
                        <tr>
                            {% if (key2 != "score") and (key2 != "Depth") %}
                                <td style = "color:red; padding-left: 50px;">
                                    {{key2}}
                                </td>

                                {% for key3 in project[key][key2].keys() %}
                                    <tr>
                                        {% if (key3 != "score") and (key3 != "Depth") %}
                                            <td  style = "color:blue; padding-left: 100px;">
                                                {{key3}}
                                            </td>
                                            <td>
                                                {{project[key][key2][key3]}}
                                            </td>
                                        {% endif %}
                                    </tr>
                                {% endfor %}
                            {% endif %}
                        </tr>
                        {% endfor %}
                    {% endif %}
                {% endfor %}
            
        {% endif %}
            
            



        </tbody>
    </table>


</div>
<br><br>
<div  class="section text-center" >
    <button  type="button" class="btn_login" data-bs-toggle="modal" onclick="window.location.href='{{ url_for( 'visualization' ) }}'">Show Visual</button>
    
    <button  type="button" class="btn_login" onclick = "downloadJSON()" >Download As Json File</button>
</div>
<br><br><br><br>
<script>

    function readTextFile(file, callback) {
          var rawFile = new XMLHttpRequest();
          rawFile.overrideMimeType("application/json");
          rawFile.open("GET", file, true);
          rawFile.onreadystatechange = function() {
              if (rawFile.readyState === 4 && rawFile.status == "200") {
                  callback(rawFile.responseText);
              }
          }
          rawFile.send(null);
      }

      function downloadJSON(){
          console.log("deneme")
          readTextFile("static/ProjectFile.json", function(text){
              scores = JSON.parse(text);
              console.log(scores);
              // onDownload();
              onDownload(scores);
          });
      }
    //usage:


      function download(content, fileName, contentType) {
          const a = document.createElement("a");
          const file = new Blob([content], { type: contentType });
          a.href = URL.createObjectURL(file);
          a.download = fileName;
          a.click();
      }

      function onDownload(scores){
      download(JSON.stringify(scores,null,2), "complexityCalculatedList.json", "\t");
      }

  </script>
{% endblock %}
{% block main %}
{% endblock %}
